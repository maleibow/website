<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matthew M. Leibowitz - Personal Website</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css"> <style>
        /* Minimal inline styles, primarily for modal content sizing if needed */
        #mediaModal .modal-body iframe, 
        #mediaModal .modal-body video,
        #mediaModal .modal-body audio {
            max-width: 100%;
            height: auto;
            aspect-ratio: 16 / 9;
            border-radius: var(--border-radius); /* Uses CSS variable from style.css */
        }
        #mediaModal .modal-body audio {
            width: 100%; 
            aspect-ratio: auto;
        }
        section[id] {
            scroll-margin-top: 5rem; 
        }
        
        /* Style for clickable project titles that trigger modals */
        .project-title-trigger {
            cursor: pointer;
            display: inline-block; 
        }
        .project-title-trigger:hover {
            color: var(--accent-color); 
            text-decoration: underline;
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div>
                    <a href="#" class="text-2xl font-bold">Matthew M. Leibowitz</a>
                </div>
                <nav id="main-nav" class="space-x-1 md:space-x-2">
                    <a href="#hero-section" class="nav-link px-3 py-2 rounded-md text-sm font-medium">Home</a>
                    <a href="#about-section" class="nav-link px-3 py-2 rounded-md text-sm font-medium">About</a>
                    <a href="#projects-section" class="nav-link px-3 py-2 rounded-md text-sm font-medium">Projects</a>
                    <a href="#contact-section" class="nav-link px-3 py-2 rounded-md text-sm font-medium">Contact</a>
                </nav>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-6">
        
        <section id="hero-section" class="text-center py-12 md:py-16 bg-highlight rounded-lg shadow-sm my-8">
            <h1 class="text-3xl sm:text-4xl md:text-5xl font-bold text-primary mb-3 mt-8">Matthew Leibowitz</h1>
            <p class="text-lg md:text-xl text-secondary mb-6">Musician / Sound Mixer / Artist</p>
            <p class="max-w-2xl mx-auto text-secondary mb-8 px-4">
                Based in Brooklyn, NY, I delve into the surreal in both sound and visuals. 
                This website showcases my work in production sound, art, and other creative projects.
            </p>
            <a href="#about-section" class="bg-accent text-white font-semibold px-6 py-3 rounded-md hover:bg-primary transition-colors shadow-md text-sm sm:text-base">Learn More About Me</a>
        </section>

        <section id="about-section" class="bg-white p-6 md:p-8 lg:p-12 rounded-lg shadow-md my-8 md:my-12">
            <div class="flex flex-col md:flex-row items-start md:gap-8">
                <img src="https://www.dropbox.com/scl/fi/ag84yx037hghie51qva7t/00127.jpg?rlkey=rm5o03g3pj0jvgdp0iag6zoum&st=rr03lzc4&raw=1" alt="Matthew M. Leibowitz Profile Picture" class="w-32 h-32 md:w-48 md:h-48 rounded-full shadow-lg mb-6 md:mb-0 object-cover flex-shrink-0 mx-auto md:mx-0" onerror="this.onerror=null;this.src='https://placehold.co/200x200/e2e8f0/1a202c?text=ML';">
                <div class="flex-grow">
                    <h2 class="text-2xl md:text-3xl lg:text-4xl font-bold text-primary mb-4">About Me</h2>
                    <p class="text-secondary text-base lg:text-lg mb-4">
                        I'm Matt Leibowitz, a musician, sound mixer, and artist based in Brooklyn, NY. I delve into the surreal in both sound and visuals. 
                        What started as a therapeutic exercise has evolved into a collection of collages, merging stream of consciousness words and thoughts 
                        with materials sourced from magazines and books.
                    </p>
                    <p class="text-secondary text-base lg:text-lg mb-6">
                        The result is a collection of non-linear stories, akin to dreams on paper, each uniquely encapsulating a narrative that evolves 
                        and transforms with the viewer's interpretation. Influenced by surrealism and the inherent absurdity of life, I invite you into 
                        a dreamscape where everyday elements assume unexpected meanings. It's an avant-garde journey that deftly blurs the boundaries 
                        between the conscious and abstract realms, presenting a discernibly familiar, yet captivatingly distinct perspective on the 
                        tapestry of human experience.
                    </p>
                </div>
            </div>
            </section>

        <section id="projects-section" class="my-8 md:my-12">
            <h2 class="text-2xl md:text-3xl lg:text-4xl font-bold text-primary mb-10 md:mb-12 text-center">My Projects</h2>
            
            <div class="space-y-10 md:space-y-12">
                <div id="project_totinos" class="project-card bg-white p-6 md:p-8 rounded-lg shadow-md flex flex-col md:flex-row items-start gap-6">
                    <img src="https://i.ytimg.com/vi/rXlxIF-sIg4/hqdefault.jpg" alt="Totino's: Pete's Za Party Thumbnail" class="w-full md:w-1/3 h-auto max-h-[210px] object-cover rounded-md shadow-sm" onerror="this.onerror=null;this.src='https://placehold.co/300x200/e5e7eb/4a5568?text=Totino%27s+Video';">
                    <div class="project-details md:w-2/3">
                        <h3 data-type="youtube" data-src="https://www.youtube.com/watch?v=VIDEO_ID6" class="modal-trigger project-title-trigger text-xl md:text-2xl font-semibold text-primary mb-1">Totino's: Pete's Za Party</h3>
                        <p class="text-sm text-subtle-text-color mb-3">Category: Production Sound Mixing</p>
                        <p class="text-secondary text-sm mb-4">
                            Served as the Production Sound Mixer for the "Pete's Za Party" commercial for Totino's. 
                            Responsible for capturing clear and high-quality audio on set.
                        </p>
                        <div class="mt-auto">
                            <button data-type="youtube" data-src="https://www.youtube.com/watch?v=VIDEO_ID6" class="modal-trigger bg-accent text-white px-4 py-2 rounded-md text-sm font-medium">View Details</button>
                        </div>
                    </div>
                </div>

                <div id="project_nyt" class="project-card bg-white p-6 md:p-8 rounded-lg shadow-md flex flex-col md:flex-row items-start gap-6">
                     <img src="https://i.ytimg.com/vi/9y2WezKYgo4/hqdefault.jpg" alt="NYT Cooking: Food Waste Thumbnail" class="w-full md:w-1/3 h-auto max-h-[210px] object-cover rounded-md shadow-sm" onerror="this.onerror=null;this.src='https://placehold.co/300x200/e5e7eb/4a5568?text=NYT+Cooking';">
                    <div class="project-details md:w-2/3">
                        <h3 data-type="youtube" data-src="https://www.youtube.com/watch?v=VIDEO_ID7" class="modal-trigger project-title-trigger text-xl md:text-2xl font-semibold text-primary mb-1">What Happens to NYC's Food Waste? | On the Job | Priya Krishna | NYT Cooking</h3>
                        <p class="text-sm text-subtle-text-color mb-3">Category: Production Sound Mixing | Client: NYT Cooking</p>
                        <p class="text-secondary text-sm mb-4">
                            Production Sound Mixer for this insightful segment of NYT Cooking's "On the Job" series featuring Priya Krishna. Directed by Amanda Choy.
                        </p>
                         <div class="mt-auto">
                            <button data-type="youtube" data-src="https://www.youtube.com/watch?v=VIDEO_ID7" class="modal-trigger bg-accent text-white px-4 py-2 rounded-md text-sm font-medium">Watch Segment</button>
                        </div>
                    </div>
                </div>
                
                <div id="project_evening_song" class="project-card bg-white p-6 md:p-8 rounded-lg shadow-md flex flex-col md:flex-row items-start gap-6">
                    <img src="https://i.ytimg.com/vi/VXaOQWb8a7c/hqdefault.jpg" alt="An Evening Song Thumbnail" class="w-full md:w-1/3 h-auto max-h-[210px] object-cover rounded-md shadow-sm" onerror="this.onerror=null;this.src='https://placehold.co/300x200/e5e7eb/4a5568?text=Evening+Song+Video';">
                    <div class="project-details md:w-2/3">
                        <h3 data-type="youtube" data-src="https://www.youtube.com/embed/9y2WezKYgo4?si=MuGof91eAF_VZb-m" class="modal-trigger project-title-trigger text-xl md:text-2xl font-semibold text-primary mb-1">An Evening Song (for Three Voices) (First Look 2024)</h3>
                        <p class="text-sm text-subtle-text-color mb-3">Category: Production Sound Mixing | Film</p>
                        <p class="text-secondary text-sm mb-4">
                           Production Sound Mixer for the film "An Evening Song (for Three Voices)". Director: Graham Swon. Cinematographer: Bart Cortright.
                        </p>
                        <div class="mt-auto">
                            <button data-type="youtube" data-src="https://www.youtube.com/embed/9y2WezKYgo4?si=MuGof91eAF_VZb-m" class="modal-trigger bg-accent text-white px-4 py-2 rounded-md text-sm font-medium">View Trailer</button>
                        </div>
                    </div>
                </div>

                <div id="project_collages" class="project-card bg-white p-6 md:p-8 rounded-lg shadow-md flex flex-col md:flex-row items-start gap-6">
                    <a href="collages.html" target="_blank" rel="noopener noreferrer" class="w-full md:w-1/3 block">
                        <img src="https://www.dropbox.com/scl/fi/ct6g4eivn84ybocvy0sb1/A-Funeral.jpg?rlkey=g3srjtt6bnyo9d5q613fk8cla&st=bgpx21c6&raw=1" alt="Collage Preview" class="w-full h-auto max-h-[210px] object-cover rounded-md shadow-sm" onerror="this.onerror=null;this.src='https://placehold.co/300x210/e5e7eb/4a5568?text=Collages';">
                    </a>
                    <div class="project-details md:w-2/3">
                        <h3 class="text-xl md:text-2xl font-semibold text-primary mb-1">
                            <a href="collages.html" target="_blank" rel="noopener noreferrer" class="hover:text-accent hover:underline">Collages</a>
                        </h3>
                        <p class="text-sm text-subtle-text-color mb-3">Category: Visual Art</p>
                        <p class="text-secondary text-sm mb-4">
                           A selection of my collage art. Click to view the full gallery.
                        </p>
                         <div class="mt-auto">
                            <a href="collages.html" target="_blank" rel="noopener noreferrer" class="bg-accent text-white px-4 py-2 rounded-md text-sm font-medium inline-block">View Full Gallery</a>
                        </div>
                    </div>
                </div>
                
                <div id="project_secret_voicemail" class="project-card bg-white p-6 md:p-8 rounded-lg shadow-md flex flex-col md:flex-row items-start gap-6">
                    <a href="https://soundcloud.com/secretvoicemail" target="_blank" rel="noopener noreferrer" class="w-full md:w-1/3 block">
                        <img src="https://i1.sndcdn.com/avatars-000227421880-1ofq7n-t500x500.jpg" alt="Secret Voicemail Project Thumbnail" class="w-full h-auto max-h-[210px] object-cover rounded-md shadow-sm" onerror="this.onerror=null;this.src='https://placehold.co/300x210/e5e7eb/4a5568?text=Secret+Voicemail';">
                    </a>
                    <div class="project-details md:w-2/3">
                        <h3 class="text-xl md:text-2xl font-semibold text-primary mb-1">
                            <a href="https://soundcloud.com/secretvoicemail" target="_blank" rel="noopener noreferrer" class="hover:text-accent hover:underline">Secret Voicemail</a>
                        </h3>
                        <p class="text-sm text-subtle-text-color mb-3">Category: Experimental Project</p>
                        <p class="text-secondary text-sm mb-4">
                           An experimental project that allows people to leave anonymous voicemail messages containing secrets that are then shared with the world. 
                           The call is free, and the words and sounds left are up to the caller.
                        </p>
                        <div class="mt-auto">
                             <a href="https://soundcloud.com/secretvoicemail" target="_blank" rel="noopener noreferrer" class="bg-accent text-white px-4 py-2 rounded-md text-sm font-medium inline-block hover:bg-primary">Visit Project Site</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="contact-section" class="max-w-xl mx-auto bg-white p-6 md:p-8 lg:p-10 rounded-lg shadow-md my-8 md:my-12">
            <h2 class="text-2xl md:text-3xl font-bold text-primary mb-6 md:mb-8 text-center">Get In Touch</h2>
            <p class="text-secondary text-center mb-6 md:mb-8">
                I'm always open to discussing new projects, collaborations, creative ideas, or opportunities. 
                Feel free to reach out.
            </p>

            <div class="mb-8 text-center space-y-4">
                <div>
                    <h3 class="text-lg font-semibold text-primary mb-1">Email</h3>
                    <p class="text-secondary hover:text-accent transition-colors"><a href="mailto:maleibow@gmail.com">maleibow@gmail.com</a></p>
                </div>
                <div>
                    <h3 class="text-lg font-semibold text-primary mt-3 mb-1">Phone</h3>
                    <p class="text-secondary hover:text-accent transition-colors"><a href="tel:+16095292804">+1 609 529 2804</a></p>
                </div>
            </div>
            
            <div class="mb-8 text-center">
                 <h3 class="text-lg font-semibold text-primary mt-6 mb-2">Connect on Social Media</h3>
                <div class="flex justify-center space-x-5 mt-2">
                    <a href="https://www.instagram.com/iammattmichael/" target="_blank" rel="noopener noreferrer" title="Instagram" class="text-subtle-text-color hover:text-accent transition-colors">
                        <svg class="w-7 h-7" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 1.172.052 1.791.218 2.427.465.66.254 1.216.598 1.772 1.153.548.548.89 1.099 1.135 1.758.25.631.42 1.253.469 2.427.058 1.267.07 1.646.07 4.85s-.012 3.584-.07 4.85c-.052 1.172-.218 1.791-.469 2.427a5.003 5.003 0 0 1-1.135 1.758c-.556.556-1.112.9-1.772 1.153-.636.247-1.255.413-2.427.465-1.267.058-1.646.07-4.85.07s-3.584-.012-4.85-.07c-1.172-.052-1.791-.218-2.427-.465a5.003 5.003 0 0 1-1.772-1.153c-.548-.548-.89-1.099-1.135-1.758-.25-.631-.42-1.253-.469-2.427-.058-1.267-.07-1.646-.07-4.85s.012-3.584.07-4.85c.052-1.172.218-1.791.469-2.427.254-.66.598-1.216 1.135-1.758.556-.556 1.112-.9 1.772-1.153.636-.247 1.255.413 2.427.465C8.416 2.175 8.796 2.163 12 2.163m0-2.163C8.74 0 8.31 0 4.85 0 1.831.083.083 1.831 0 4.85 0 8.31.083 8.74 0 12s.083 3.69.083 7.15c0 3.018 1.748 4.765 4.767 4.848C8.31 23.917 8.74 24 12 24s3.69-.083 7.15-.083c3.018 0 4.765-1.748 4.848-4.767C23.917 15.69 24 15.26 24 12s-.083-3.69-.083-7.15C24 1.831 22.169.083 19.15 0 15.69 0 15.26.083 12 0zm0 5.838a6.162 6.162 0 1 0 0 12.324 6.162 6.162 0 0 0 0-12.324zM12 16a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm6.406-11.845a1.44 1.44 0 1 0 0-2.88 1.44 1.44 0 0 0 0 2.88z"/></svg>
                        <span class="sr-only">Instagram</span>
                    </a>
                </div>
            </div>

            <form action="#" method="POST" class="space-y-5 mt-8">
                <div>
                    <label for="name" class="block text-sm font-medium text-primary mb-1">Full Name</label>
                    <input type="text" name="name" id="name" autocomplete="name" required
                           class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-accent focus:border-accent sm:text-sm">
                </div>
                <div>
                    <label for="email_form" class="block text-sm font-medium text-primary mb-1">Email Address</label>
                    <input type="email" name="email_form" id="email_form" autocomplete="email" required
                           class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-accent focus:border-accent sm:text-sm">
                </div>
                <div>
                    <label for="subject" class="block text-sm font-medium text-primary mb-1">Subject</label>
                    <input type="text" name="subject" id="subject" required
                           class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-accent focus:border-accent sm:text-sm">
                </div>
                <div>
                    <label for="message" class="block text-sm font-medium text-primary mb-1">Message</label>
                    <textarea id="message" name="message" rows="4" required
                              class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-accent focus:border-accent sm:text-sm"></textarea>
                </div>
                <div>
                    <button type="submit"
                            class="w-full flex justify-center py-2.5 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-accent hover:bg-primary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent transition-colors">
                        Send Message
                    </button>
                </div>
            </form>
        </section>

    </main>

    <footer class="bg-secondary text-white py-8 mt-12">
        <div class="container mx-auto px-6 text-center">
            <p class="mb-2 text-sm">© <span id="currentYear"></span> Matthew M. Leibowitz. All rights reserved.</p>
            <div class="space-x-4">
                <a href="https://www.instagram.com/iammattmichael/" target="_blank" rel="noopener noreferrer" class="hover:text-highlight transition-colors text-sm">Instagram</a>
            </div>
        </div>
    </footer>

    <div id="mediaModal" class="modal-overlay fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-[100] hidden opacity-0">
        <div class="modal-content bg-white p-4 sm:p-6 rounded-lg shadow-xl w-full max-w-xl md:max-w-2xl transform scale-95 opacity-0">
            <div class="flex justify-between items-center mb-4">
                <h3 id="mediaModalTitle" class="text-lg font-semibold text-primary">Media Preview</h3> 
                <button id="closeMediaModal" class="text-2xl">×</button> 
            </div>
            <div id="mediaModalBody" class="modal-body"> 
            </div>
        </div>
    </div>

    <div id="collageDetailModal" class="modal-overlay fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center p-4 z-[150] hidden opacity-0">
        <div class="modal-content bg-white p-2 sm:p-3 rounded-lg shadow-xl w-auto max-w-[90vw] max-h-[90vh] relative transform scale-95 opacity-0">
            <button id="closeCollageDetailModal" class="absolute top-2 right-2 text-3xl text-primary hover:text-accent leading-none z-20 bg-white bg-opacity-70 rounded-full w-10 h-10 flex items-center justify-center">×</button>
            <div id="collageDetailModalBody" class="w-full h-full flex items-center justify-center">
                <img src="" alt="Enlarged Collage" class="block max-w-full max-h-full object-contain rounded-md">
            </div>
        </div>
    </div>


    <script>
        document.getElementById('currentYear').textContent = new Date().getFullYear();
        
        // Active Nav Link Script
        document.addEventListener('DOMContentLoaded', function() {
            const navLinks = document.querySelectorAll('#main-nav a.nav-link');
            const sections = [];
            navLinks.forEach(link => {
                try {
                    const sectionId = link.hash ? link.hash.substring(1) : null;
                    if (sectionId) {
                        const section = document.getElementById(sectionId);
                        if (section) sections.push(section);
                        else console.warn(`Section ID '${sectionId}' not found.`);
                    }
                } catch (e) { console.error("Error processing nav link:", link, e); }
            });

            function setActiveLink() {
                let currentSectionId = '';
                const scrollPosition = window.scrollY;
                const offset = window.innerHeight * 0.4;
                sections.forEach(section => {
                    if (!section) return;
                    if (scrollPosition >= section.offsetTop - offset && scrollPosition < section.offsetTop + section.offsetHeight - offset) {
                        currentSectionId = section.id;
                    }
                });
                if (!currentSectionId && sections.length > 0) {
                    let closestSection = sections[0];
                    if (closestSection) {
                        let minDistance = Math.abs(scrollPosition + offset - closestSection.offsetTop);
                        sections.forEach(section => {
                            if (!section) return;
                            const distance = Math.abs(scrollPosition + offset - section.offsetTop);
                            if (distance < minDistance) {
                                minDistance = distance;
                                closestSection = section;
                            }
                        });
                        currentSectionId = closestSection.id;
                    }
                }
                navLinks.forEach(link => {
                    link.classList.remove('bg-highlight', 'text-accent', 'font-semibold');
                    if (link.hash === `#${currentSectionId}`) {
                        link.classList.add('bg-highlight', 'text-accent', 'font-semibold');
                    }
                });
            }
            window.addEventListener('scroll', setActiveLink);
            setActiveLink(); 
        });

        // General Modal Logic
        function setupModal(modalId, openTriggersQuery, closeButtonId, modalBodyIdOrImgSelector, contentSetupFn) {
            const modal = document.getElementById(modalId);
            const modalContentEl = modal ? modal.querySelector('.modal-content') : null;
            const closeButton = closeButtonId ? document.getElementById(closeButtonId) : null;
            const triggerButtons = openTriggersQuery ? document.querySelectorAll(openTriggersQuery) : [];

            if (!modal || !modalContentEl) {
                return;
            }
            
            const openTheModal = (data) => {
                let targetEl;
                if (typeof modalBodyIdOrImgSelector === 'string' && modalBodyIdOrImgSelector.startsWith('#')) {
                    targetEl = document.getElementById(modalBodyIdOrImgSelector.substring(1));
                } else if (typeof modalBodyIdOrImgSelector === 'string') { 
                    targetEl = modal.querySelector(modalBodyIdOrImgSelector);
                }


                if (contentSetupFn && targetEl) {
                    contentSetupFn(targetEl, data);
                }
                modal.classList.remove('hidden');
                setTimeout(() => {
                    modal.classList.remove('opacity-0');
                    modalContentEl.classList.remove('scale-95', 'opacity-0');
                }, 10);
            };

            const closeTheModal = () => {
                modal.classList.add('opacity-0');
                modalContentEl.classList.add('scale-95', 'opacity-0');
                setTimeout(() => {
                    modal.classList.add('hidden');
                    let targetEl;
                     if (typeof modalBodyIdOrImgSelector === 'string' && modalBodyIdOrImgSelector.startsWith('#')) {
                        targetEl = document.getElementById(modalBodyIdOrImgSelector.substring(1));
                    } else if (typeof modalBodyIdOrImgSelector === 'string') {
                        targetEl = modal.querySelector(modalBodyIdOrImgSelector);
                    }

                    if (targetEl) {
                        if (targetEl.tagName === 'IMG') {
                            targetEl.src = ''; 
                        } else { 
                            const iframe = targetEl.querySelector('iframe');
                            const audio = targetEl.querySelector('audio');
                            if (iframe) iframe.src = ''; 
                            if (audio) { audio.pause(); audio.src = ''; }
                            targetEl.innerHTML = ''; 
                        }
                    }
                }, 300);
            };

            triggerButtons.forEach(button => {
                button.addEventListener('click', (event) => {
                    const data = { ...button.dataset }; 
                    
                    if (modalId === 'mediaModal') { 
                        const projectCard = button.closest('.project-card');
                        data.title = projectCard?.querySelector('.project-details h3')?.textContent || 'Media Preview';
                        if(button.classList.contains('project-title-trigger')) {
                            data.title = button.textContent;
                        }
                    } else if (modalId === 'collageDetailModal') { 
                        data.src = button.src; 
                        data.alt = button.alt;
                        data.title = button.alt || 'Collage Detail';
                    }

                    if (data.src || (data.type && data.src)) {
                        openTheModal(data);
                    } else {
                        console.error('Trigger button is missing required data attributes (src or type).', button);
                    }
                });
            });

            if (closeButton) closeButton.addEventListener('click', closeTheModal);
            modal.addEventListener('click', (event) => {
                if (event.target === modal) closeTheModal();
            });
            document.addEventListener('keydown', (event) => {
                if (event.key === 'Escape' && !modal.classList.contains('hidden')) closeTheModal();
            });
        }

        // Setup for Media Modal (YouTube/Audio)
        setupModal('mediaModal', '.modal-trigger', 'closeMediaModal', '#mediaModalBody', (bodyEl, data) => {
            let embedContent = '';
            const modalTitleEl = document.getElementById('mediaModalTitle'); 
            if(modalTitleEl) modalTitleEl.textContent = data.title || 'Media Preview';

            if (data.type === 'youtube') {
                if (data.src) { // Directly use data.src, assuming it's a correct embed URL
                     embedContent = `<iframe class="w-full aspect-video" src="${data.src}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`;
                } else {
                    console.error('YouTube data.src is missing.');
                    embedContent = '<p class="text-red-600 p-4">Error: YouTube video source is missing.</p>';
                }
            } else if (data.type === 'audio') {
                embedContent = `<audio controls class="w-full mt-2" src="${data.src}">Your browser does not support the audio element.</audio>`;
            } else if (data.type === 'iframe') {
                 embedContent = `<iframe src="${data.src}" class="w-full h-96 md:h-[500px]" frameborder="0" allowfullscreen></iframe>`;
            } else {
                embedContent = '<p class="text-red-600 p-4">Error: Unsupported media type.</p>';
            }
            bodyEl.innerHTML = embedContent;
        });
        
        setupModal('collageDetailModal', '.collage-thumbnail', 'closeCollageDetailModal', '#collageDetailModalBody img', (imgEl, data) => {
            imgEl.src = data.src; 
            imgEl.alt = data.alt || 'Enlarged Collage';
        });

    </script>

</body>
</html>
